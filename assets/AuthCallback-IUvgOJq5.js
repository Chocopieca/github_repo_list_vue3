import{a as u,i as h,H as d,b as p,e as s,o as m}from"./index-DXCCDWmc.js";import{u as f}from"./githubAuth-BM_8Igaf.js";const _={class:"flex items-center justify-center min-h-screen"},k=u({__name:"AuthCallback",setup(g){const o=d(),c=f();return h(async()=>{const r=new URLSearchParams(window.location.search),e=r.get("code"),n=r.get("state"),i=localStorage.getItem("github_auth_state");if(localStorage.removeItem("github_auth_state"),!n||n!==i){console.error("Invalid state parameter"),o.push("/");return}if(e)try{const t=await fetch("/github-oauth/access_token",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({client_id:void 0,client_secret:void 0,code:e})});if(!t.ok){const l=await t.text();throw new Error(`Failed to exchange code for token: ${l}`)}const a=await t.json();if(a.error)throw new Error(a.error_description||a.error);c.setToken(a.access_token),o.push("/")}catch(t){console.error("Failed to exchange code for token:",t),o.push("/")}else o.push("/")}),(r,e)=>(m(),p("div",_,e[0]||(e[0]=[s("div",{class:"text-center"},[s("h2",{class:"text-xl font-bold mb-4"},"Authenticating..."),s("p",{class:"text-gray-600"},"Please wait while we complete the authentication process.")],-1)])))}});export{k as default};
